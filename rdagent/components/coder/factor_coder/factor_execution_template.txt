import os

import numpy as np
import pandas as pd
from factor import feat_eng

if os.path.exists("valid.csv"):
    train_df = pd.read_csv("valid.csv")
elif os.path.exists("valid.pkl"):
    train_df = pd.read_pickle("valid.pkl")
else:
    raise FileNotFoundError("No train data found.")

new_feat = feat_eng(train_df)
new_feat.to_hdf("result.h5", key="data", mode="w")
