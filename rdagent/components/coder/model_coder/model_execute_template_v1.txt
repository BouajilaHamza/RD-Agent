# MODEL_TYPE = "Tabular"
# BATCH_SIZE = 32
# NUM_FEATURES = 32
# NUM_TIMESTEPS = 32
# NUM_EDGES = 20
# INPUT_VALUE = 1.0
# PARAM_INIT_VALUE = 1.0

import pickle

import torch
from model import model_cls
# torch.manual_seed(int(INPUT_VALUE))

m = model_cls(num_features=NUM_FEATURES)
# node_features = torch.randn(BATCH_SIZE, NUM_FEATURES)
node_features = torch.Tensor([[8.6100e-01, 1.3033e-01, 4.4820e-01, 2.7759e-01, 3.4044e-01, 2.2740e-01,
         5.9748e-01, 2.1722e-01, 6.9327e-01, 5.6252e-01, 1.7446e-01, 1.0502e-01,
         9.8329e-01, 3.4526e-01, 2.5108e-01, 2.2682e-01, 7.8643e-01, 2.3411e-02,
         4.6794e-01, 6.8647e-01, 8.2984e-01, 1.5024e-01, 6.1168e-01, 7.7209e-01,
         2.8372e-01, 6.2257e-01, 1.7392e-01, 3.3282e-01, 6.0355e-01, 3.0337e-02,
         1.6349e-01, 2.8189e-01],
        [8.6509e-01, 2.7637e-01, 2.4031e-01, 2.4863e-01, 8.1475e-01, 1.8369e-03,
         4.4333e-01, 4.8074e-02, 1.5887e-01, 3.0822e-01, 2.9361e-01, 4.0700e-01,
         5.0701e-01, 2.0395e-01, 1.2261e-01, 3.4279e-01, 5.3220e-01, 2.3952e-01,
         4.6587e-01, 1.2526e-01, 5.5677e-04, 7.9192e-01, 6.3067e-01, 9.4382e-01,
         6.8120e-01, 3.9742e-02, 3.2404e-01, 7.9601e-01, 5.0767e-01, 7.0429e-01,
         1.9276e-03, 2.0339e-01],
        [5.4895e-01, 5.4216e-01, 7.0160e-01, 7.4313e-01, 3.5030e-01, 5.5094e-01,
         8.9975e-02, 8.7711e-01, 2.2719e-01, 2.1700e-02, 3.7624e-01, 8.4984e-01,
         4.8635e-02, 3.1388e-01, 8.2659e-01, 3.3299e-01, 4.3199e-01, 7.2260e-01,
         1.1590e-01, 3.2965e-01, 8.9042e-01, 7.9813e-01, 5.1878e-01, 1.5294e-01,
         4.3883e-01, 4.8457e-01, 3.3951e-01, 8.6235e-01, 9.4439e-01, 4.4807e-01,
         6.0823e-01, 5.2021e-01],
        [4.0355e-01, 7.1991e-01, 2.2965e-01, 8.0114e-01, 2.5704e-01, 2.6001e-01,
         6.7222e-01, 3.9832e-01, 3.1699e-01, 1.2564e-01, 9.9458e-01, 3.9827e-02,
         8.8632e-01, 4.6720e-01, 2.4586e-01, 3.6364e-01, 7.3713e-01, 4.2585e-02,
         7.8276e-01, 8.3046e-01, 8.9546e-01, 6.7686e-01, 3.1868e-01, 2.9770e-01,
         2.9748e-01, 1.4117e-01, 3.6904e-01, 4.3191e-01, 9.3906e-01, 6.7610e-01,
         3.1513e-02, 1.1331e-01],
        [8.5203e-01, 2.8392e-01, 6.1856e-01, 7.7637e-01, 7.0698e-01, 3.2774e-01,
         4.7606e-01, 2.0299e-01, 3.9153e-01, 5.7094e-01, 3.6208e-01, 6.3030e-01,
         5.3932e-01, 7.6671e-01, 8.2616e-01, 9.8563e-01, 5.7003e-01, 7.5917e-01,
         8.7932e-01, 1.2348e-01, 1.9931e-01, 4.4527e-01, 7.8189e-01, 4.5467e-01,
         6.7496e-02, 8.8062e-01, 4.9492e-01, 5.3366e-01, 8.9674e-02, 1.8607e-01,
         3.5418e-02, 9.7401e-01],
        [2.4990e-01, 8.8663e-02, 1.7672e-01, 4.7030e-01, 7.3114e-01, 9.2930e-01,
         6.6682e-01, 1.7439e-02, 9.9825e-01, 5.3954e-01, 4.9269e-01, 9.4817e-01,
         8.8788e-01, 3.5076e-02, 3.3474e-01, 7.4001e-01, 6.3839e-01, 9.4288e-01,
         1.5749e-01, 9.9280e-01, 3.7337e-01, 5.1876e-01, 8.1939e-01, 5.9867e-02,
         8.1897e-01, 7.8942e-01, 4.7790e-01, 9.7785e-01, 2.2498e-02, 4.3472e-01,
         9.3044e-01, 9.3208e-01],
        [5.5073e-01, 7.1895e-02, 5.8137e-01, 7.5526e-01, 1.2301e-01, 2.8935e-01,
         7.8924e-01, 3.1310e-01, 5.1628e-01, 9.4836e-01, 6.8318e-01, 7.2820e-01,
         4.1787e-01, 6.3320e-01, 6.0193e-02, 1.3518e-02, 9.5686e-01, 3.0408e-01,
         2.7434e-01, 4.2806e-01, 3.2239e-01, 8.6726e-01, 5.2059e-01, 7.5206e-01,
         1.9337e-01, 6.0972e-01, 4.9580e-01, 6.7893e-01, 5.6071e-01, 1.2426e-02,
         8.7891e-03, 7.6277e-01],
        [9.5517e-01, 1.9036e-01, 8.4879e-01, 2.5579e-01, 6.2373e-01, 2.8326e-02,
         4.4525e-01, 3.7440e-03, 1.9800e-01, 2.6916e-01, 3.2389e-01, 8.5258e-01,
         7.3029e-01, 5.9708e-01, 6.0577e-01, 3.1276e-01, 4.6943e-02, 3.1824e-01,
         4.6817e-01, 5.3788e-01, 8.1926e-01, 3.0165e-01, 4.5844e-01, 8.5331e-01,
         7.5702e-01, 3.3064e-01, 4.7624e-01, 3.1289e-01, 7.5231e-01, 7.4440e-01,
         9.4149e-01, 2.0495e-01],
        [1.8046e-01, 5.9303e-01, 3.7840e-03, 6.7088e-01, 4.8201e-02, 8.8693e-01,
         5.5608e-01, 9.6528e-01, 7.5102e-01, 1.8948e-01, 5.9400e-01, 3.4729e-02,
         9.4592e-01, 1.1707e-01, 2.1957e-01, 2.0502e-01, 3.4813e-01, 9.4591e-03,
         1.4406e-02, 7.4287e-01, 3.6075e-01, 3.3576e-01, 3.0862e-01, 1.0077e-01,
         6.3184e-01, 9.3400e-01, 7.3683e-02, 7.4978e-01, 9.4692e-02, 8.1654e-01,
         8.0716e-01, 1.1239e-02],
        [2.7211e-01, 1.2922e-01, 7.7680e-01, 9.5739e-01, 5.6778e-01, 9.6446e-01,
         9.5475e-01, 9.4427e-01, 6.3123e-02, 8.6138e-01, 7.9521e-01, 7.4628e-01,
         4.0302e-02, 3.3554e-01, 5.0929e-01, 9.9060e-01, 9.8989e-01, 3.8458e-01,
         2.2851e-01, 6.4747e-01, 5.5130e-01, 8.5073e-01, 1.5958e-01, 6.3782e-01,
         8.7729e-01, 8.6379e-01, 6.6606e-02, 3.7249e-01, 1.2978e-01, 4.8094e-01,
         5.5240e-01, 2.6960e-01],
        [4.1603e-01, 9.8552e-01, 2.2741e-01, 8.6599e-01, 8.3200e-01, 6.6919e-01,
         8.2081e-01, 1.0288e-01, 7.0107e-01, 7.3817e-01, 1.7280e-01, 5.7120e-02,
         1.2853e-01, 6.5264e-02, 7.1348e-01, 5.8931e-01, 7.4686e-02, 5.9714e-01,
         9.4388e-02, 3.1559e-01, 5.0667e-01, 3.5294e-01, 8.8304e-01, 3.7470e-01,
         9.3314e-01, 8.9867e-01, 1.6992e-01, 4.3546e-01, 1.4223e-01, 6.4657e-02,
         2.5158e-01, 4.8713e-01],
        [6.3525e-01, 1.3727e-01, 7.7611e-01, 2.3712e-01, 8.5922e-01, 8.9806e-01,
         7.0876e-01, 8.5089e-01, 9.0046e-01, 9.9553e-01, 9.3465e-01, 5.3027e-01,
         3.2932e-01, 5.2178e-01, 6.9207e-01, 8.6469e-02, 1.4274e-01, 8.1733e-01,
         6.2940e-01, 7.7511e-01, 7.7980e-01, 1.0142e-01, 8.4697e-01, 7.2700e-02,
         2.8924e-01, 5.4028e-01, 2.2184e-01, 3.3180e-01, 1.1446e-01, 2.0972e-01,
         2.0331e-01, 5.1037e-01],
        [3.4755e-01, 5.3638e-01, 2.1296e-01, 1.1257e-01, 7.9617e-01, 5.9183e-01,
         4.0883e-02, 8.0972e-01, 1.5840e-01, 2.2282e-01, 7.3620e-01, 8.5749e-01,
         4.3779e-02, 7.6872e-01, 3.5233e-01, 8.0196e-01, 1.7839e-01, 4.4623e-01,
         9.1965e-01, 8.8057e-01, 1.5935e-01, 8.8618e-01, 7.4919e-01, 1.0925e-01,
         6.9577e-01, 3.1095e-01, 2.6669e-01, 2.7983e-01, 1.3255e-01, 3.8998e-01,
         9.8670e-01, 3.5092e-01],
        [8.4325e-01, 5.7284e-01, 1.9761e-01, 4.4363e-01, 4.6958e-01, 3.7207e-01,
         9.8342e-01, 4.8009e-02, 1.5363e-01, 3.4402e-01, 3.8437e-01, 2.2028e-01,
         9.6093e-01, 5.8745e-02, 9.3462e-02, 8.5638e-02, 5.7629e-01, 2.8289e-01,
         5.5378e-01, 2.0857e-01, 6.0675e-02, 6.8530e-01, 5.4175e-01, 7.5323e-01,
         8.9225e-01, 4.8444e-02, 4.6665e-01, 6.1191e-01, 8.4006e-01, 5.6053e-01,
         1.5113e-01, 8.7530e-01],
        [9.1000e-01, 3.4594e-01, 1.9148e-01, 7.7674e-01, 4.9714e-01, 6.6373e-01,
         7.1040e-02, 3.3760e-01, 5.3656e-01, 5.2995e-01, 3.6786e-01, 9.6188e-01,
         9.4781e-01, 6.3552e-01, 3.9827e-02, 9.9062e-01, 9.1414e-01, 6.6523e-01,
         2.7159e-01, 6.2792e-01, 9.9520e-01, 5.5787e-01, 5.3847e-01, 6.7254e-01,
         6.6711e-02, 9.4255e-01, 6.9752e-01, 8.6091e-01, 1.2661e-01, 5.7755e-01,
         3.4828e-01, 4.8962e-01],
        [9.3712e-01, 4.8703e-01, 1.9918e-01, 6.0304e-01, 5.1426e-01, 2.0770e-01,
         9.6387e-01, 7.2954e-01, 2.9414e-01, 5.1694e-01, 4.1177e-01, 7.6792e-01,
         4.1331e-01, 9.3989e-01, 5.5067e-01, 7.7202e-01, 6.1830e-01, 8.4604e-01,
         6.3947e-01, 2.6092e-01, 9.5313e-01, 6.4286e-01, 8.6569e-01, 6.0039e-01,
         3.2020e-02, 4.2632e-01, 4.3309e-01, 3.7270e-01, 7.1094e-01, 2.7955e-01,
         4.2929e-01, 2.8967e-01],
        [5.6055e-01, 9.2460e-01, 3.7931e-01, 3.0776e-01, 5.7859e-01, 3.3895e-01,
         9.2948e-01, 8.1338e-01, 3.0169e-01, 8.6034e-01, 7.7400e-01, 1.3349e-01,
         8.5001e-01, 9.3381e-01, 2.5308e-02, 3.5505e-01, 6.0417e-01, 4.6624e-01,
         5.4887e-01, 8.0294e-01, 2.5959e-01, 8.2904e-01, 4.0625e-01, 9.2746e-01,
         4.5226e-01, 3.6521e-01, 5.4227e-01, 6.1657e-01, 5.2325e-01, 3.7166e-01,
         1.2792e-01, 1.5494e-02],
        [2.0822e-01, 2.3760e-01, 6.1293e-01, 4.3436e-02, 6.3296e-01, 6.5331e-01,
         6.2203e-01, 5.7496e-01, 9.2692e-01, 4.5079e-01, 4.0703e-01, 5.2479e-01,
         1.2549e-01, 5.2736e-01, 3.4380e-01, 4.2801e-01, 6.2361e-01, 9.7610e-02,
         6.1942e-01, 4.3472e-01, 9.4832e-01, 9.2976e-01, 8.7984e-01, 6.3520e-02,
         6.6969e-02, 9.8798e-01, 7.2260e-01, 5.6169e-01, 2.6070e-01, 8.5012e-01,
         6.6084e-01, 3.3986e-01],
        [9.7051e-01, 7.0194e-02, 1.1819e-01, 6.4472e-01, 2.6658e-01, 4.5846e-01,
         6.3453e-01, 4.2290e-01, 9.8369e-01, 2.6929e-02, 8.9780e-01, 7.2322e-01,
         5.0501e-01, 7.3794e-01, 8.7330e-01, 1.6304e-01, 7.7918e-01, 1.4981e-01,
         2.0318e-02, 1.8675e-01, 7.0885e-02, 3.9903e-01, 8.5196e-01, 5.7985e-01,
         9.7628e-01, 1.1305e-01, 6.7189e-01, 2.8372e-01, 7.1556e-01, 7.8065e-01,
         9.1350e-01, 2.9282e-01],
        [2.5037e-01, 1.5357e-01, 4.5279e-01, 4.4294e-01, 8.4985e-01, 1.4198e-01,
         2.8926e-01, 3.3063e-02, 6.1916e-01, 7.6311e-01, 4.4012e-01, 8.4960e-01,
         9.9382e-02, 2.5277e-01, 3.0964e-01, 4.9687e-01, 9.6519e-01, 5.9129e-01,
         6.9869e-01, 2.1110e-02, 4.0377e-01, 4.4066e-01, 8.1806e-01, 4.5693e-01,
         2.8694e-01, 5.5301e-01, 2.8181e-01, 6.6572e-01, 1.5230e-01, 2.2175e-01,
         8.2385e-01, 3.1928e-01],
        [9.7283e-01, 5.8221e-01, 9.2963e-01, 3.6149e-01, 9.2110e-01, 3.2023e-01,
         8.6472e-01, 1.6071e-01, 5.2502e-01, 8.7054e-01, 9.6960e-01, 3.0431e-01,
         5.5242e-01, 6.9594e-01, 2.4084e-01, 2.9827e-01, 2.1155e-02, 6.6158e-01,
         3.6941e-01, 5.4848e-01, 9.4252e-02, 4.5740e-01, 4.1224e-01, 2.4933e-01,
         9.4651e-01, 5.5773e-01, 5.5476e-01, 4.8677e-01, 7.0580e-01, 8.9871e-01,
         8.1918e-01, 3.5018e-01],
        [3.2313e-01, 5.4942e-01, 6.5937e-01, 8.8336e-01, 9.2957e-01, 5.1435e-01,
         3.2645e-01, 8.0370e-01, 3.3842e-01, 4.2205e-03, 3.0868e-01, 9.3732e-01,
         1.2835e-01, 9.4527e-02, 2.4341e-01, 3.9255e-01, 4.5257e-01, 1.3394e-01,
         1.0570e-01, 2.0341e-01, 7.4879e-01, 9.2497e-01, 3.0468e-01, 3.2096e-01,
         3.5239e-01, 4.2691e-01, 6.2911e-01, 8.8777e-01, 8.4321e-01, 3.5403e-01,
         1.6064e-01, 1.1923e-01],
        [1.2459e-01, 3.9847e-01, 5.1620e-01, 9.3289e-01, 9.5462e-01, 6.7841e-01,
         2.9392e-01, 3.4310e-01, 1.5597e-01, 5.1035e-01, 6.0348e-01, 1.8092e-01,
         4.5573e-01, 6.1108e-01, 7.7382e-01, 9.2168e-01, 1.3930e-01, 1.3236e-01,
         4.3637e-01, 8.9824e-01, 9.0419e-01, 2.3656e-01, 8.1280e-03, 7.2886e-01,
         1.1149e-01, 5.9487e-01, 3.5625e-01, 7.4899e-01, 6.5065e-01, 1.3126e-02,
         7.9038e-01, 8.6659e-01],
        [7.6866e-01, 5.5374e-01, 8.6113e-01, 3.2043e-02, 7.3431e-01, 4.8110e-01,
         7.4653e-01, 4.3801e-01, 3.7112e-02, 7.6741e-01, 6.7130e-01, 6.3981e-02,
         7.7578e-01, 9.3443e-01, 5.9316e-01, 6.7693e-02, 5.9995e-01, 2.2901e-01,
         5.7298e-01, 5.1132e-01, 8.3873e-03, 1.3785e-01, 3.3123e-01, 2.9161e-01,
         5.4898e-01, 8.6570e-01, 6.6411e-02, 3.4436e-01, 5.6113e-01, 5.2905e-01,
         1.5580e-01, 4.7431e-01],
        [6.0318e-01, 5.7124e-01, 2.1148e-01, 1.5846e-01, 3.9143e-01, 8.1767e-01,
         8.0988e-01, 6.3278e-01, 6.8054e-01, 7.5885e-01, 6.4584e-01, 4.0574e-01,
         5.0623e-01, 6.4335e-01, 8.9686e-02, 7.9145e-01, 4.2080e-01, 4.9715e-01,
         6.8167e-01, 7.6347e-01, 1.7536e-01, 8.5493e-02, 6.4923e-01, 6.5340e-01,
         5.8926e-03, 8.6429e-01, 2.4852e-01, 2.8997e-01, 4.0959e-01, 6.7803e-01,
         1.5468e-01, 4.1366e-01],
        [3.1900e-01, 4.4098e-01, 6.1986e-01, 1.6665e-01, 9.9919e-02, 7.6784e-01,
         3.8325e-01, 9.0087e-02, 7.8310e-01, 9.2259e-01, 3.9438e-01, 7.8536e-01,
         7.0209e-01, 7.6518e-01, 8.6704e-01, 1.8286e-01, 7.2940e-01, 2.1752e-01,
         9.9774e-01, 3.6846e-01, 6.7050e-01, 2.8488e-02, 9.3423e-02, 3.1437e-01,
         5.3099e-01, 5.0335e-01, 6.2065e-01, 1.7521e-01, 7.4603e-01, 6.1917e-01,
         1.7386e-01, 7.6143e-02],
        [4.2539e-02, 1.2441e-02, 4.4642e-01, 1.3209e-01, 9.5372e-01, 3.7120e-01,
         6.1264e-01, 8.3590e-01, 5.4036e-01, 2.1416e-01, 3.2016e-01, 4.5731e-01,
         7.7082e-01, 3.9945e-01, 3.9475e-01, 1.7075e-01, 1.1626e-01, 7.8212e-01,
         3.4884e-01, 6.4583e-01, 5.6132e-02, 9.3717e-02, 8.4193e-01, 1.4262e-02,
         2.8858e-01, 1.8107e-01, 9.7049e-02, 9.7523e-01, 8.4995e-01, 6.6897e-01,
         5.6202e-01, 2.0361e-01],
        [1.2014e-01, 2.0963e-01, 4.1580e-01, 4.8243e-01, 7.0017e-01, 5.1507e-01,
         6.9365e-01, 3.4483e-01, 8.1553e-01, 7.0345e-01, 1.3810e-01, 8.5188e-01,
         8.8401e-01, 4.5513e-01, 6.8598e-01, 3.4081e-01, 2.8419e-02, 7.3870e-01,
         7.0523e-01, 6.9606e-01, 1.5997e-01, 5.4505e-02, 4.9277e-01, 1.0845e-01,
         2.6029e-01, 4.8385e-01, 7.7993e-01, 9.8704e-01, 4.8976e-01, 3.7981e-01,
         9.4837e-01, 4.8099e-01],
        [3.9555e-01, 1.6429e-01, 2.5395e-01, 4.4650e-01, 2.8410e-02, 9.4937e-01,
         1.1482e-01, 4.2326e-01, 6.6101e-01, 5.3653e-01, 2.4175e-02, 3.3867e-01,
         1.6756e-01, 4.4101e-02, 5.4167e-02, 6.2574e-01, 2.8950e-01, 2.6788e-01,
         8.1868e-01, 3.8844e-01, 6.5014e-01, 5.0494e-01, 4.5036e-01, 9.3388e-01,
         6.4905e-01, 3.9730e-01, 3.3886e-01, 7.4943e-01, 1.6045e-01, 3.1769e-01,
         2.4587e-01, 3.5011e-01],
        [1.8710e-01, 1.1645e-01, 5.5069e-01, 8.7707e-01, 9.4073e-01, 8.7511e-01,
         1.8652e-02, 1.8886e-01, 4.6040e-01, 2.0658e-01, 2.0248e-01, 2.6705e-01,
         3.7726e-02, 5.3447e-01, 6.6706e-01, 7.4226e-01, 8.2424e-03, 9.0648e-01,
         4.8998e-01, 7.5873e-01, 4.7765e-01, 2.5315e-01, 4.7118e-01, 4.9752e-01,
         3.6421e-01, 3.9905e-01, 5.0493e-01, 2.6547e-01, 5.0936e-01, 8.7574e-01,
         9.3493e-01, 2.1440e-01],
        [5.1540e-01, 9.8933e-01, 1.5214e-01, 3.4122e-01, 5.3726e-01, 6.6502e-01,
         8.9121e-01, 6.8823e-01, 6.3088e-01, 7.8141e-02, 5.6607e-01, 6.7199e-01,
         5.2025e-01, 9.6153e-01, 3.7949e-01, 7.7831e-01, 7.2928e-01, 2.8023e-02,
         2.6911e-01, 4.8038e-01, 9.3692e-01, 1.0983e-01, 3.2652e-01, 6.3592e-01,
         3.9710e-01, 3.8280e-01, 8.4157e-01, 6.3917e-01, 8.1840e-01, 1.4893e-01,
         2.4392e-01, 5.6951e-01],
        [4.0259e-01, 8.5020e-01, 2.0554e-01, 5.4449e-01, 2.9847e-01, 5.2648e-01,
         7.9336e-01, 3.4395e-01, 7.6142e-02, 4.5716e-01, 4.8124e-01, 7.6054e-01,
         5.8536e-01, 3.1529e-01, 1.1286e-01, 3.1296e-01, 4.8319e-01, 5.2916e-01,
         9.7103e-01, 3.3876e-01, 2.4040e-01, 5.0614e-02, 3.8729e-01, 9.7576e-02,
         9.2611e-01, 7.8535e-01, 3.8245e-01, 5.8444e-02, 6.4251e-01, 3.6619e-01,
         7.2335e-01, 5.7498e-01]])
# edge_index = torch.randint(0, BATCH_SIZE, (2, NUM_EDGES))
edge_index = torch.Tensor([[14, 25, 19,  1, 27,  7,  0, 24,  6, 29, 25, 29,  4, 12,  7, 17,  4, 10,
         21, 23],
        [26,  7,  3, 31,  4, 12, 16, 29, 10, 24, 21,  0,  6, 25,  2,  4, 18,  5,
         28, 23]])
edge_index = edge_index.to(torch.int64)
# Initialize all parameters of `m` to `param_init_value`
for _, param in m.named_parameters():
    param.data.fill_(PARAM_INIT_VALUE)
print ("node_features",node_features)
print ("edge_index",edge_index)

out = m(node_features=node_features,edge_index=edge_index)

execution_model_output = out.cpu().detach().numpy()
execution_feedback_str = f"Execution successful, output tensor shape: {execution_model_output.shape}"

pickle.dump(execution_model_output, open("execution_model_output.pkl", "wb"))
pickle.dump(execution_feedback_str, open("execution_feedback_str.pkl", "wb"))
